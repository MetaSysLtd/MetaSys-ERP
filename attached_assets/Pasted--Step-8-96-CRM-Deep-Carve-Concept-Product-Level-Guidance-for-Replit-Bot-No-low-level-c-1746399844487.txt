ğŸ“â€¯Stepâ€¯8â€¯Â·â€¯96 â€” â€œCRM Deepâ€‘Carveâ€ (Concept / Productâ€‘Level Guidance forâ€¯Replitâ€‘Bot)

(No lowâ€‘level code; pure product & dataâ€‘logic so the agent can build correctly.)


---

1.â€¯Why weâ€™re doing this

Sales reps only sell.

Dispatchers only move freight.

Data handâ€‘off must be complete & auditable so neither side reâ€‘types info or blames the other.

CRM must therefore look more like HubSpot / Pipedrive than a halfâ€‘baked â€œlead + createâ€‘loadâ€ list.



---

2.â€¯New CRM Information Architecture (Sidebar)

CRM
 â”œâ”€ Leads              (SQL + MQL pipelines)
 â”œâ”€ Accounts           (companies/clients, readâ€‘only for Sales)
 â”œâ”€ Activities         (call & email logs, tasks, reminders)
 â”œâ”€ Surveys            (NPS / simple feedback forms)
 â””â”€ Commissions

Remove the â€œCreateâ€¯Loadâ€ action from CRM entirely.


---

3.â€¯Key Concepts & Flows

3.1â€¯Lead Lifecycle

Whenever a lead moves stage:

1. Append timeline entry.


2. Push notification to relevant team(s).


3. Emit WebSocket event so dashboards refresh.



3.2â€¯Activity Feed Rules

Everything that happens to a lead or account funnels into activities table.

UI shows a vertical timeline (like HubSpot activity).

Sales & Dispatch see the same feed; dispatch adds load notes, sales adds call notes.


3.3â€¯Reminders / Followâ€‘ups

New â€œFollowâ€‘upâ€ button in Activity Feed â†’ sets dueDate + reminderType.

Daily CRON job triggers Slack + inâ€‘app notification: â€œğŸ””Â Followâ€‘up with ABC Logistics (lead #123)â€.


3.4â€¯Customer Surveys

Simple oneâ€‘page form link (/survey/:leadId/:token).

After load #3, system autoâ€‘emails survey.

Survey result (1â€‘5 NPS & comment) writes to surveys table and posts to Activity Feed.



---

4.â€¯Data Model Additions (high level)

classDiagram
    Lead *-- Activity
    Lead *-- Survey
    Account <|-- Lead
    class Lead {
      id UUID
      accountId UUID
      ownerId UUID
      stage enum
      source enum
      mcNumber string
      mcAgeMonths int
      callAttempts int
      createdAt
    }
    class Activity {
      id UUID
      leadId UUID
      type enum(call,email,note,statusChange,reminder,survey)
      payload JSONB
      createdBy UUID
      createdAt
    }
    class Survey {
      id UUID
      leadId UUID
      score int
      comment text
      createdAt
    }


---

5.â€¯Permissions & UX

Disable â€œCreate Loadâ€ button for any user not in Dispatch role.



---

6.â€¯UI / UX Microâ€‘Guidelines

Leads page default = Kanban; switch to list via toggle.

Each lead card shows: Company, Contact, Stage, Source badge (SQL/MQL), callAttempts/3.

Activity Feed uses colourâ€‘coded icons (ğŸ“, âœ‰ï¸, ğŸ“, ğŸ”„, ğŸ•‘).

Surveys tab lists response score & comment; show â€œğŸ˜Š / ğŸ˜ / ğŸ˜ â€ emoji indicator.

Reminder chip appears red on dayâ€¯due, grey when future, green when done.



---

7.â€¯Acceptance Tests (Replitâ€‘Bot must selfâ€‘confirm)

1. Create SQL Lead â†’ appears stage=New, Activity entry created.


2. Log 3 calls â†’ move to HandToDispatch succeeds; dispatch gets notification.


3. Dispatch books load (stub) â†’ stage autoâ€‘moves Active; invoice generated.


4. Survey email stub fires after 3 loads; response 5Â â­ writes to feed.


5. Sales user cannot click â€œCreate Loadâ€; button absent.


6. Dispatch user can click â€œCreate Loadâ€ under DispatchÂ >Â Clients.




---

âœ…Â Deliverables

Updated DB migration & seed script.

New /api/activities, /api/surveys, /api/followups endpoints.

React components for ActivityFeed, SurveyList, Reminder modal.

Unit + Playwright tests covering lifecycle flow.


(Copy this conceptual brief to Replitâ€‘Bot; let it design code internally.)


---

When the bot says â€œPASS: CRM Deepâ€‘Carve implementedâ€, run a quick smoke test; then weâ€™ll proceed to GPS Clockâ€‘In (StepÂ 8â€¯Â·â€¯9).

